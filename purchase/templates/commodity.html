{% extends "index.html" %}
{% block details %}
  
<div class="container">
    <div class="page-header">
        <h2>商品管理</h2>        
    </div>
    <div id="toolbar" class="btn-group">
        <button id="btn_add" type="button" class="btn btn-default">
            <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>新增
        </button>
        <button id="btn_edit" type="button" class="btn btn-default">
            <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>修改
        </button>
        <button id="btn_delete" type="button" class="btn btn-default">
            <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>删除
        </button>
        <button id="btn_save" type="button" class="btn btn-default">
            <span class="glyphicon glyphicon-save" aria-hidden="true"></span>保存
        </button>
        <button id="btn_export" type="button" class="btn btn-default">
            <span class="glyphicon glyphicon-export" aria-hidden="true"></span>导出
        </button>
    </div>
    <table class="table table-striped table-hover" id='table'></table>
    
</div>

<script type="text/javascript">
    $(function () {
        let $table = $('#table');
        let $btn_add = $('#btn_add');
        var tableColumns = [
            {checkbox: true},
            {field: 'commodity_serial', title: 'ID', sortable: true, editable: {required: true, type: 'text'}},
            {field: 'commodity_id', title: '商品ID', sortable: true, editable: {type: 'text', title: '用户名', validate: function (v) {if (!v) return '用户名不能为空';}}},
            {field: 'commodity_link', title: '商品链接'},
            {field: 'commodity_name', title: '商品名称', sortable: true},
            {field: 'commodity_num', title: '数量', sortable: true, editable: {type: 'text', validate: function (value) {
            if (!value){
                return '不能为空';
            }
            var regPos = /^\d+$/; 
            if(!regPos.test(value)) {
                return "请输入有效的数量";
            }
            }
            }
            },
            {field: 'commodity_price', title: '单价', sortable: true},
            {field: 'commodity_total', title: '总价', sortable: true, formatter:function(value, row, index){return row.commodity_price*row.commodity_num}},
            //{field: 'Button', title: '操作', align:"center", events: operateEvents, formatter: operateBtns, width: 180}
        ];
        $('#table').bootstrapTable('destroy');
        $btn_add.click(function() {
            $table.bootstrapTable('insertRow', {
                index: 0,
                row: {
                id: '',
                name: '',
                price: ''
            }
            });
        });
        
        $('#table').bootstrapTable({
            columns: tableColumns,
            data: {{ items|safe }},
            toolbar: '#toolbar',
            pageSize: 10,
            pageNumber: 1,
            pageList: [10,25],
            cache: false,   //不缓存
            striped: true,
            pagination: true,
            sidePagination: 'client',
            search: true,
            showRefresh: true,
            showExport: true,
            showFooter: true,
            // exportTypes: ['csv', 'txt', 'xml'],
            clickToSelect: true,
            showToggle:true,
            showColumns:true,
            cardView: false,
            editable: true,
            clickEdit: true,
            
            
        });

    });
       
</script>

{% endblock %}

